<!DOCTYPE html>
<html lang="ar" dir="rtl" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³ - Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ">
  <title>Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© - Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³</title>
  
  <!-- ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø³Ø±Ø¹Ø©: Ø¥Ø²Ø§Ù„Ø© Fonts ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… -->
  <style>
    /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ù…Ø­Ø³Ù† */
    @font-face {
      font-family: 'SystemArabic';
      src: local('Segoe UI'), local('Tahoma'), local('Arial');
    }
    
    /* CSS Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
    :root {
      --primary: #10b981;
      --primary-dark: #059669;
      --secondary: #3b82f6;
      --secondary-dark: #2563eb;
      --danger: #ef4444;
      --warning: #f59e0b;
      --dark: #1f2937;
      --light: #f9fafb;
      --glass: rgba(255, 255, 255, 0.92);
      --glass-border: rgba(255, 255, 255, 0.2);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'SystemArabic', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #f0fdf4 0%, #e0f2fe 100%);
      min-height: 100vh;
      background-attachment: fixed;
    }
    
    /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
    .glass-card {
      background: var(--glass);
      backdrop-filter: blur(16px) saturate(180%);
      border: 1px solid var(--glass-border);
      box-shadow: 
        0 4px 6px -1px rgba(0, 0, 0, 0.05),
        0 10px 15px -3px rgba(0, 0, 0, 0.07),
        0 20px 25px -5px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
    }
    
    /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
    .input-field {
      width: 100%;
      padding: 0.875rem 1rem;
      border: 2px solid #e5e7eb;
      border-radius: 0.75rem;
      transition: all 0.2s ease;
      font-size: 1rem;
      background: white;
    }
    
    .input-field:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.15);
      outline: none;
    }
    
    .input-field:disabled {
      background: #f3f4f6;
      cursor: not-allowed;
    }
    
    /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    .btn {
      transition: all 0.2s ease;
      cursor: pointer;
      user-select: none;
      position: relative;
      overflow: hidden;
    }
    
    .btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%);
      transform-origin: 50% 50%;
    }
    
    .btn:active::after {
      animation: ripple 0.6s ease-out;
    }
    
    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }
      100% {
        transform: scale(20, 20);
        opacity: 0;
      }
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .btn:active {
      transform: translateY(0);
    }
    
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }
    
    /* Animations */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
      20%, 40%, 60%, 80% { transform: translateX(5px); }
    }
    
    .animate-slide-in {
      animation: slideIn 0.3s ease-out;
    }
    
    .animate-fade-in {
      animation: fadeIn 0.3s ease-out;
    }
    
    .shake {
      animation: shake 0.5s;
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    .skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
      border-radius: 0.5rem;
    }
    
    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªÙ…Ø±ÙŠØ± */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #a1a1a1;
    }
    
    /* ØªØ£Ø®ÙŠØ± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ± */
    .lazy {
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .lazy.loaded {
      opacity: 1;
    }
  </style>
  
  <!-- ØªØ­Ù…ÙŠÙ„ Tailwind Ø¨Ø´ÙƒÙ„ ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù† -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#10b981',
            secondary: '#3b82f6'
          }
        }
      },
      corePlugins: {
        preflight: false, // Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØ¹Ø§Ø±Ø¶ Ù…Ø¹ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø®ØµØµØ©
      }
    }
  </script>
</head>
<body class="antialiased">

<!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
<div id="loading-bar" class="fixed top-0 left-0 right-0 h-1 bg-gradient-to-r from-green-500 to-blue-500 z-50" style="transform: translateX(-100%);"></div>

<main class="min-h-screen py-6 px-4 flex justify-center">
  <div class="w-full max-w-4xl">
    
    <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <header class="text-center mb-8 animate-slide-in">
      <div class="inline-flex items-center gap-2 bg-gradient-to-r from-green-500 to-blue-500 text-white px-6 py-2 rounded-full mb-3">
        <span class="text-lg">âœ¨</span>
        <span class="font-bold">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ…</span>
      </div>
      <h1 class="text-3xl md:text-4xl font-black text-gray-800 mb-2">Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h1>
      <p class="text-gray-600">Ø¥Ø´Ø±Ø§Ù : Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ</p>
    </header>

    <!-- Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹ -->
    <div class="mb-6 animate-slide-in">
      <div class="flex flex-wrap gap-2 mb-3">
        <button onclick="testScript()" class="btn bg-blue-500 hover:bg-blue-600 text-white px-5 py-2.5 rounded-xl font-bold">
          ğŸ”§ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„
        </button>
        <button onclick="showAdminLogin()" class="btn bg-gray-800 hover:bg-gray-900 text-white px-5 py-2.5 rounded-xl font-bold">
          ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†
        </button>
      </div>
      <div id="test-result" class="glass-card p-4 rounded-xl text-sm min-h-[80px]">
        <div class="text-gray-500 text-center py-4">âš¡ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„" Ù„Ù„Ø¨Ø¯Ø¡</div>
      </div>
    </div>

    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
    <div id="form-container" class="animate-slide-in">
      <form id="join-form" class="glass-card rounded-2xl p-6 space-y-4">
        
        <div class="text-center mb-2">
          <h2 class="text-xl font-bold text-gray-800">ğŸ“ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</h2>
          <p class="text-gray-600 text-sm mt-1">Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹</p>
        </div>

        <!-- Ø§Ù„Ø§Ø³Ù… -->
        <div>
          <label for="name" class="block text-sm font-bold text-gray-700 mb-1">
            ğŸ‘¤ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ <span class="text-red-500">*</span>
          </label>
          <input 
            type="text" 
            id="name" 
            name="name"
            required 
            minlength="3"
            maxlength="100"
            class="input-field" 
            placeholder="Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø³Ø§Ù„Ù…"
            autocomplete="name"
          >
        </div>

        <!-- Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ -->
        <div>
          <label for="email" class="block text-sm font-bold text-gray-700 mb-1">
            ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ <span class="text-red-500">*</span>
          </label>
          <input 
            type="email" 
            id="email" 
            name="email"
            required 
            class="input-field" 
            placeholder="Ù…Ø«Ø§Ù„: name@example.com"
            autocomplete="email"
            inputmode="email"
          >
        </div>

        <!-- Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ -->
        <div>
          <label for="phone" class="block text-sm font-bold text-gray-700 mb-1">
            ğŸ“± Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ <span class="text-red-500">*</span>
          </label>
          <div class="relative">
            <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500">+968</div>
            <input 
              type="tel" 
              id="phone" 
              name="phone"
              required 
              pattern="[0-9]{8}" 
              minlength="8"
              maxlength="8"
              class="input-field pl-16" 
              placeholder="99123456"
              autocomplete="tel"
              inputmode="numeric"
            >
          </div>
        </div>

        <!-- Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© ÙˆØ§Ù„ÙˆÙ„Ø§ÙŠØ© -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label for="governorate" class="block text-sm font-bold text-gray-700 mb-1">
              ğŸ›ï¸ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©
            </label>
            <select id="governorate" name="governorate" class="input-field">
              <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©...</option>
              <option value="Ù…Ø³Ù‚Ø·">Ù…Ø³Ù‚Ø·</option>
              <option value="Ø¸ÙØ§Ø±">Ø¸ÙØ§Ø±</option>
              <option value="Ù…Ø³Ù†Ø¯Ù…">Ù…Ø³Ù†Ø¯Ù…</option>
              <option value="Ø§Ù„Ø¨Ø±ÙŠÙ…ÙŠ">Ø§Ù„Ø¨Ø±ÙŠÙ…ÙŠ</option>
              <option value="Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©">Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©</option>
              <option value="Ø´Ù…Ø§Ù„ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©">Ø´Ù…Ø§Ù„ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©</option>
              <option value="Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©">Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©</option>
              <option value="Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
              <option value="Ø´Ù…Ø§Ù„ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø´Ù…Ø§Ù„ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
              <option value="Ø§Ù„Ø¸Ø§Ù‡Ø±Ø©">Ø§Ù„Ø¸Ø§Ù‡Ø±Ø©</option>
              <option value="Ø§Ù„ÙˆØ³Ø·Ù‰">Ø§Ù„ÙˆØ³Ø·Ù‰</option>
            </select>
          </div>

          <div>
            <label for="wilayat" class="block text-sm font-bold text-gray-700 mb-1">
              ğŸ“ Ø§Ù„ÙˆÙ„Ø§ÙŠØ©
            </label>
            <select id="wilayat" name="wilayat" class="input-field" disabled>
              <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ©...</option>
            </select>
          </div>
        </div>

        <!-- Ø§Ù„Ù…Ø¯Ø±Ø³Ø© -->
        <div>
          <label for="school" class="block text-sm font-bold text-gray-700 mb-1">
            ğŸ« Ø§Ù„Ù…Ø¯Ø±Ø³Ø©
          </label>
          <input 
            type="text" 
            id="school" 
            name="school"
            class="input-field" 
            placeholder="Ù…Ø«Ø§Ù„: Ù…Ø¯Ø±Ø³Ø© Ø³Ø¹Ø¯ Ø¨Ù† Ù…Ø¹Ø§Ø°"
            maxlength="100"
          >
        </div>

        <!-- Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ -->
        <button 
          type="submit" 
          id="submit-btn" 
          class="btn bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white w-full py-3 rounded-xl font-bold text-lg shadow-lg mt-2"
        >
          âœ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…
        </button>

        <div id="form-status" class="hidden p-4 rounded-xl text-center font-bold"></div>
      </form>
    </div>

    <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ -->
    <div id="success-message" class="hidden glass-card rounded-2xl p-6 text-center animate-slide-in">
      <div class="text-5xl mb-4">ğŸ‰</div>
      <h2 class="text-2xl font-bold text-green-600 mb-2">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!</h2>
      <p class="text-gray-600 mb-4">Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ! Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.</p>
      <button onclick="resetForm()" class="btn bg-blue-500 hover:bg-blue-600 text-white px-5 py-2.5 rounded-xl font-bold">
        ğŸ“ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø¢Ø®Ø±
      </button>
    </div>

  </div>
</main>

<!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ† -->
<div id="admin-login-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 animate-fade-in">
  <div class="glass-card rounded-xl p-6 max-w-md w-full animate-slide-in">
    <h2 class="text-xl font-bold text-gray-800 mb-4 text-center">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†</h2>
    
    <form id="admin-login-form" class="space-y-4">
      <div>
        <label for="admin-password" class="block text-sm font-bold text-gray-700 mb-2">
          ğŸ”‘ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        </label>
        <input 
          type="password" 
          id="admin-password" 
          required 
          class="input-field" 
          placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
          autocomplete="current-password"
        >
      </div>
      
      <div id="login-error" class="hidden bg-red-100 text-red-700 p-3 rounded-lg text-sm text-center font-bold"></div>
      
      <div class="flex gap-2">
        <button 
          type="submit" 
          id="login-btn"
          class="btn bg-green-500 hover:bg-green-600 text-white px-5 py-2.5 rounded-xl font-bold flex-1"
        >
          âœ… Ø¯Ø®ÙˆÙ„
        </button>
        <button 
          type="button" 
          onclick="hideAdminLogin()"
          class="btn bg-gray-500 hover:bg-gray-600 text-white px-5 py-2.5 rounded-xl font-bold flex-1"
        >
          âœ• Ø¥Ù„ØºØ§Ø¡
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ† -->
<div id="admin-panel" class="hidden fixed inset-0 bg-gray-900 p-4 z-50 overflow-auto">
  <div class="max-w-7xl mx-auto">
    
    <!-- Ø±Ø£Ø³ Ø§Ù„Ù„ÙˆØ­Ø© -->
    <header class="glass-card rounded-xl p-4 mb-4">
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
        <div>
          <h1 class="text-xl font-bold text-white">ğŸ›ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
          <p class="text-gray-400 text-sm">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†</p>
        </div>
        <div class="flex gap-2">
          <button onclick="exportData()" class="btn bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">
            ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          </button>
          <button onclick="logoutAdmin()" class="btn bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm">
            ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
          </button>
        </div>
      </div>
    </header>

    <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-4">
      
      <!-- Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ -->
      <div class="glass-card p-4 rounded-xl">
        <h3 class="text-white font-bold mb-3">ğŸ”§ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„</h3>
        <div class="space-y-2">
          <button onclick="adminTestConnection()" class="btn bg-blue-500 hover:bg-blue-600 text-white w-full py-2 rounded-lg">
            Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³ÙƒØ±Ø¨ÙŠØª
          </button>
          <button onclick="loadAllRecords()" class="btn bg-green-500 hover:bg-green-600 text-white w-full py-2 rounded-lg">
            Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          </button>
        </div>
        <div id="admin-test-result" class="text-white text-sm mt-3 p-3 bg-gray-800 rounded-lg min-h-[60px]"></div>
      </div>
      
      <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
      <div class="glass-card p-4 rounded-xl">
        <h3 class="text-white font-bold mb-3">ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h3>
        <div class="grid grid-cols-2 gap-3">
          <div class="bg-gray-800 p-4 rounded-lg text-center">
            <div class="text-sm text-gray-400 mb-1">Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
            <div id="total-count" class="text-2xl font-bold text-white">0</div>
          </div>
          <div class="bg-gray-800 p-4 rounded-lg text-center">
            <div class="text-sm text-gray-400 mb-1">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</div>
            <div id="remaining-count" class="text-2xl font-bold text-white">0</div>
          </div>
          <div class="bg-gray-800 p-4 rounded-lg text-center">
            <div class="text-sm text-gray-400 mb-1">Ø§Ù„ÙŠÙˆÙ…</div>
            <div id="today-count" class="text-2xl font-bold text-white">0</div>
          </div>
          <div class="bg-gray-800 p-4 rounded-lg text-center">
            <div class="text-sm text-gray-400 mb-1">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
            <div id="week-count" class="text-2xl font-bold text-white">0</div>
          </div>
        </div>
      </div>
      
      <!-- Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ© -->
      <div class="glass-card p-4 rounded-xl">
        <h3 class="text-white font-bold mb-3">ğŸ” Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ©</h3>
        <div class="space-y-2">
          <input 
            type="text" 
            id="search-input" 
            placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯..."
            class="input-field bg-gray-800 border-gray-700 text-white"
            onkeyup="filterRecords()"
          >
          <select id="filter-governorate" class="input-field bg-gray-800 border-gray-700 text-white" onchange="filterRecords()">
            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª</option>
            <option value="Ù…Ø³Ù‚Ø·">Ù…Ø³Ù‚Ø·</option>
            <option value="Ø¸ÙØ§Ø±">Ø¸ÙØ§Ø±</option>
            <option value="Ù…Ø³Ù†Ø¯Ù…">Ù…Ø³Ù†Ø¯Ù…</option>
            <option value="Ø§Ù„Ø¨Ø±ÙŠÙ…ÙŠ">Ø§Ù„Ø¨Ø±ÙŠÙ…ÙŠ</option>
            <option value="Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©">Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©</option>
            <option value="Ø´Ù…Ø§Ù„ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©">Ø´Ù…Ø§Ù„ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©</option>
            <option value="Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©">Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©</option>
            <option value="Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
            <option value="Ø´Ù…Ø§Ù„ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø´Ù…Ø§Ù„ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
            <option value="Ø§Ù„Ø¸Ø§Ù‡Ø±Ø©">Ø§Ù„Ø¸Ø§Ù‡Ø±Ø©</option>
            <option value="Ø§Ù„ÙˆØ³Ø·Ù‰">Ø§Ù„ÙˆØ³Ø·Ù‰</option>
          </select>
          <button onclick="clearFilters()" class="btn bg-gray-700 hover:bg-gray-600 text-white w-full py-2 rounded-lg">
            ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±
          </button>
        </div>
      </div>
      
    </div>

    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª -->
    <div class="glass-card rounded-xl p-4 mb-4">
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-3 mb-4">
        <h2 class="text-lg font-bold text-white">ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
        <div class="flex gap-2">
          <button onclick="loadAllRecords()" class="btn bg-purple-500 hover:bg-purple-600 text-white px-3 py-1.5 rounded-lg text-sm">
            ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          </button>
          <button onclick="toggleView()" id="toggle-view-btn" class="btn bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded-lg text-sm">
            ğŸ‘ï¸ Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„
          </button>
        </div>
      </div>
      
      <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª -->
      <div id="cards-view" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
        <div id="records-list" class="space-y-3"></div>
      </div>
      
      <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
      <div id="table-view" class="hidden overflow-x-auto">
        <table class="w-full text-sm text-white">
          <thead class="bg-gray-800">
            <tr>
              <th class="p-3 text-right">#</th>
              <th class="p-3 text-right">Ø§Ù„Ø§Ø³Ù…</th>
              <th class="p-3 text-right">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
              <th class="p-3 text-right">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
              <th class="p-3 text-right">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th>
              <th class="p-3 text-right">Ø§Ù„ÙˆÙ„Ø§ÙŠØ©</th>
              <th class="p-3 text-right">Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th>
              <th class="p-3 text-right">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>
            </tr>
          </thead>
          <tbody id="table-body" class="divide-y divide-gray-700"></tbody>
        </table>
      </div>
      
      <!-- ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØµÙØ­Ø§Øª -->
      <div id="pagination" class="mt-4 flex justify-center gap-2 hidden">
        <button onclick="changePage(-1)" class="btn bg-gray-700 hover:bg-gray-600 text-white px-3 py-1 rounded-lg text-sm">
          Ø§Ù„Ø³Ø§Ø¨Ù‚
        </button>
        <span id="page-info" class="text-white px-3 py-1"></span>
        <button onclick="changePage(1)" class="btn bg-gray-700 hover:bg-gray-600 text-white px-3 py-1 rounded-lg text-sm">
          Ø§Ù„ØªØ§Ù„ÙŠ
        </button>
      </div>
    </div>

    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ -->
    <div class="glass-card rounded-xl p-4">
      <h3 class="text-white font-bold mb-3">ğŸ› Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­</h3>
      <div id="debug-info" class="text-yellow-300 text-xs bg-gray-800 p-3 rounded-lg overflow-x-auto whitespace-pre"></div>
    </div>

  </div>
</div>

<script>
// ============================================
// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ - Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±
// ============================================
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwRU0C6bbgpnbXNAwC_fVgXfWxs_dFezEmsK0vQSJLfw1vlrjKDKIdyWU4K9ziddzf6/exec';

// Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø©
let isSubmitting = false;
let adminPassword = null;
let allRecords = [];
let filteredRecords = [];
let currentPage = 1;
const recordsPerPage = 12;
let isTableView = false;

// ============================================
// ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
// ============================================

// Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
const cache = {
    test: null,
    records: null,
    timestamp: null
};

// ØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
function saveToLocalStorage(key, data) {
    try {
        const item = {
            data: data,
            timestamp: Date.now()
        };
        localStorage.setItem(key, JSON.stringify(item));
    } catch (e) {
        console.warn('âŒ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹:', e);
    }
}

function loadFromLocalStorage(key, maxAge = 5 * 60 * 1000) {
    try {
        const item = localStorage.getItem(key);
        if (!item) return null;
        
        const parsed = JSON.parse(item);
        if (Date.now() - parsed.timestamp > maxAge) {
            localStorage.removeItem(key);
            return null;
        }
        
        return parsed.data;
    } catch (e) {
        console.warn('âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©:', e);
        return null;
    }
}

// ============================================
// Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª ÙˆØ§Ù„ÙˆÙ„Ø§ÙŠØ§Øª - Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±
// ============================================
const OMAN_WILAYAT = {
  "Ù…Ø³Ù‚Ø·": ["Ù…Ø³Ù‚Ø·", "Ù…Ø·Ø±Ø­", "Ø¨ÙˆØ´Ø±", "Ø§Ù„Ø³ÙŠØ¨", "Ø§Ù„Ø¹Ø§Ù…Ø±Ø§Øª", "Ù‚Ø±ÙŠØ§Øª"],
  "Ø¸ÙØ§Ø±": ["ØµÙ„Ø§Ù„Ø©", "Ø·Ø§Ù‚Ø©", "Ù…Ø±Ø¨Ø§Ø·", "Ø³Ø¯Ø­", "Ø±Ø®ÙŠÙˆØª", "Ø¶Ù„ÙƒÙˆØª", "Ù…Ù‚Ø´Ù†", "Ø´Ù„ÙŠÙ… ÙˆØ¬Ø²Ø± Ø§Ù„Ø­Ù„Ø§Ù†ÙŠØ§Øª", "Ø«Ù…Ø±ÙŠØª"],
  "Ù…Ø³Ù†Ø¯Ù…": ["Ø®ØµØ¨", "Ø¯Ø¨Ø§", "Ø¨Ø®Ø§", "Ù…Ø¯Ø­Ø§Ø¡"],
  "Ø§Ù„Ø¨Ø±ÙŠÙ…ÙŠ": ["Ø§Ù„Ø¨Ø±ÙŠÙ…ÙŠ", "Ù…Ø­Ø¶Ø©", "Ø§Ù„Ø³Ù†ÙŠÙ†Ø©"],
  "Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©": ["Ù†Ø²ÙˆÙ‰", "Ø¨Ù‡Ù„Ø§Ø¡", "Ù…Ù†Ø­", "Ø§Ù„Ø­Ù…Ø±Ø§Ø¡", "Ø¥Ø²ÙƒÙŠ", "Ø³Ù…Ø§Ø¦Ù„", "Ø£Ø¯Ù…"],
  "Ø´Ù…Ø§Ù„ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©": ["ØµØ­Ø§Ø±", "Ø´Ù†Ø§Øµ", "Ù„ÙˆÙ‰", "ØµØ­Ù…", "Ø§Ù„Ø®Ø§Ø¨ÙˆØ±Ø©", "Ø§Ù„Ø³ÙˆÙŠÙ‚"],
  "Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©": ["Ø§Ù„Ø±Ø³ØªØ§Ù‚", "Ø§Ù„Ø¹ÙˆØ§Ø¨ÙŠ", "Ù†Ø®Ù„", "ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù…Ø¹Ø§ÙˆÙ„", "Ø¨Ø±ÙƒØ§Ø¡"],
  "Ø´Ù…Ø§Ù„ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©": ["Ø¥Ø¨Ø±Ø§Ø¡", "Ø§Ù„Ù…Ø¶ÙŠØ¨ÙŠ", "Ø¨Ø¯ÙŠØ©", "Ø§Ù„Ù‚Ø§Ø¨Ù„", "ÙˆØ§Ø¯ÙŠ Ø¨Ù†ÙŠ Ø®Ø§Ù„Ø¯", "Ø¯Ù…Ø§Ø¡ ÙˆØ§Ù„Ø·Ø§Ø¦ÙŠÙŠÙ†"],
  "Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø´Ø±Ù‚ÙŠØ©": ["ØµÙˆØ±", "Ø¬Ø¹Ù„Ø§Ù† Ø¨Ù†ÙŠ Ø¨ÙˆØ¹Ù„ÙŠ", "Ø¬Ø¹Ù„Ø§Ù† Ø¨Ù†ÙŠ Ø¨ÙˆØ­Ø³Ù†", "Ø§Ù„ÙƒØ§Ù…Ù„ ÙˆØ§Ù„ÙˆØ§ÙÙŠ", "Ù…ØµÙŠØ±Ø©"],
  "Ø§Ù„Ø¸Ø§Ù‡Ø±Ø©": ["Ø¹Ø¨Ø±ÙŠ", "ÙŠÙ†Ù‚Ù„", "Ø¶Ù†Ùƒ"],
  "Ø§Ù„ÙˆØ³Ø·Ù‰": ["Ù‡ÙŠÙ…Ø§", "Ø§Ù„Ø¯Ù‚Ù…", "Ù…Ø­ÙˆØª", "Ø§Ù„Ø¬Ø§Ø²Ø±"]
};

// Ø±Ø¨Ø· Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¨Ø§Ù„ÙˆÙ„Ø§ÙŠØ©
document.getElementById("governorate").addEventListener("change", function() {
  const selectedGov = this.value;
  const wilayatSelect = document.getElementById("wilayat");

  wilayatSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ©...</option>';
  wilayatSelect.disabled = true;

  if (!selectedGov || !OMAN_WILAYAT[selectedGov]) return;

  OMAN_WILAYAT[selectedGov].forEach(wilaya => {
    const option = document.createElement("option");
    option.value = wilaya;
    option.textContent = wilaya;
    wilayatSelect.appendChild(option);
  });

  wilayatSelect.disabled = false;
});

// ============================================
// Ø¯ÙˆØ§Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
// ============================================

// Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ­Ø±Ùƒ
function showLoading() {
    const loadingBar = document.getElementById('loading-bar');
    loadingBar.style.transition = 'transform 0.3s ease';
    loadingBar.style.transform = 'translateX(0)';
}

function hideLoading() {
    const loadingBar = document.getElementById('loading-bar');
    loadingBar.style.transform = 'translateX(-100%)';
}

// Ø¯Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
async function testScript() {
    const resultDiv = document.getElementById('test-result');
    resultDiv.innerHTML = '<div class="flex items-center justify-center gap-2 text-blue-500"><div class="w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div>Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...</div>';
    
    try {
        showLoading();
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
        if (cache.test && Date.now() - cache.timestamp < 60000) {
            const data = cache.test;
            displayTestResult(data, true);
            hideLoading();
            return true;
        }

        const url = `${SCRIPT_URL}?action=test&t=${Date.now()}`;
        const controller = new AbortController();
        const timeout = setTimeout(() => controller.abort(), 10000);

        const response = await fetch(url, {
            method: 'GET',
            headers: { 'Accept': 'application/json' },
            signal: controller.signal
        });

        clearTimeout(timeout);

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        
        // Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
        cache.test = data;
        cache.timestamp = Date.now();
        
        displayTestResult(data);
        hideLoading();
        return true;

    } catch (error) {
        console.error('âŒ Ø®Ø·Ø£ Ø§Ù„Ø§ØªØµØ§Ù„:', error);
        
        resultDiv.innerHTML = `
            <div class="text-red-600 font-bold mb-1">âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„!</div>
            <div class="text-gray-600 text-sm">
                <p><strong>Ø§Ù„Ø®Ø·Ø£:</strong> ${error.name === 'AbortError' ? 'Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„Ø§ØªØµØ§Ù„' : error.message}</p>
                <p class="mt-2 text-xs">â±ï¸ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</p>
            </div>
        `;
        
        hideLoading();
        return false;
    }
}

function displayTestResult(data, fromCache = false) {
    const resultDiv = document.getElementById('test-result');
    const cacheBadge = fromCache ? '<span class="bg-gray-200 text-gray-700 text-xs px-2 py-0.5 rounded mr-2">Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø©</span>' : '';
    
    resultDiv.innerHTML = `
        <div class="flex items-center gap-2 mb-2">
            <div class="text-green-600 font-bold">âœ… Ø§ØªØµØ§Ù„ Ù†Ø§Ø¬Ø­!</div>
            ${cacheBadge}
        </div>
        <div class="text-gray-700 space-y-1 text-sm">
            <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${data.status}</p>
            <p><strong>Ø§Ù„Ø±Ø³Ø§Ù„Ø©:</strong> ${data.message}</p>
            ${data.version ? `<p><strong>Ø§Ù„Ø¥ØµØ¯Ø§Ø±:</strong> ${data.version}</p>` : ''}
            <p class="text-xs text-gray-500 mt-2">ğŸ•’ ${new Date().toLocaleTimeString('ar-SA')}</p>
        </div>
    `;
}

// ============================================
// Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
// ============================================
document.getElementById('join-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    if (isSubmitting) return;
    
    const submitBtn = document.getElementById('submit-btn');
    const formStatus = document.getElementById('form-status');
    const originalText = submitBtn.textContent;
    
    isSubmitting = true;
    submitBtn.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';
    submitBtn.disabled = true;
    formStatus.classList.add('hidden');
    
    // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const phone = document.getElementById('phone').value.trim();
    
    if (!validateForm(name, email, phone)) {
        isSubmitting = false;
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
        return;
    }
    
    const formData = {
        action: 'create',
        name: name,
        email: email,
        phone: phone,
        governorate: document.getElementById('governorate').value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
        wilayat: document.getElementById('wilayat').value.trim() || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
        school: document.getElementById('school').value.trim() || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
        submitted_at: new Date().toISOString()
    };
    
    try {
        showLoading();
        
        const response = await fetch(SCRIPT_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'text/plain;charset=utf-8'
            },
            body: JSON.stringify(formData)
        });
        
        const result = await response.json();
        
        if (result.status === 'success') {
            document.getElementById('form-container').classList.add('hidden');
            document.getElementById('success-message').classList.remove('hidden');
            
            // Ø¥Ø´Ø¹Ø§Ø± Ù†Ø¬Ø§Ø­
            showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
            cache.records = null;
            cache.timestamp = null;
            
        } else {
            formStatus.innerHTML = `âŒ ${result.message}`;
            formStatus.className = 'p-4 rounded-xl text-center font-bold bg-red-100 text-red-700';
            formStatus.classList.remove('hidden');
            formStatus.classList.add('shake');
            setTimeout(() => formStatus.classList.remove('shake'), 500);
            
            showNotification(result.message, 'error');
        }
        
    } catch (error) {
        console.error('âŒ Ø®Ø·Ø£ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:', error);
        formStatus.innerHTML = 'âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…';
        formStatus.className = 'p-4 rounded-xl text-center font-bold bg-red-100 text-red-700';
        formStatus.classList.remove('hidden');
        
        showNotification('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…', 'error');
    } finally {
        hideLoading();
        isSubmitting = false;
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
    }
});

function validateForm(name, email, phone) {
    const errors = [];
    
    if (name.length < 3) {
        errors.push('Ø§Ù„Ø§Ø³Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
        document.getElementById('name').classList.add('shake');
    }
    
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        errors.push('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­');
        document.getElementById('email').classList.add('shake');
    }
    
    if (!/^[0-9]{8}$/.test(phone)) {
        errors.push('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 8 Ø£Ø±Ù‚Ø§Ù…');
        document.getElementById('phone').classList.add('shake');
    }
    
    if (errors.length > 0) {
        showNotification(errors.join('<br>'), 'error');
        setTimeout(() => {
            document.querySelectorAll('.shake').forEach(el => el.classList.remove('shake'));
        }, 500);
        return false;
    }
    
    return true;
}

// ============================================
// Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
// ============================================
function showNotification(message, type = 'info') {
    const types = {
        success: { bg: 'bg-green-500', icon: 'âœ…' },
        error: { bg: 'bg-red-500', icon: 'âŒ' },
        info: { bg: 'bg-blue-500', icon: 'â„¹ï¸' },
        warning: { bg: 'bg-yellow-500', icon: 'âš ï¸' }
    };
    
    const notif = document.createElement('div');
    notif.className = `fixed top-4 left-4 right-4 md:left-auto md:right-4 md:w-96 ${types[type].bg} text-white p-4 rounded-xl shadow-lg z-[100] animate-slide-in`;
    notif.innerHTML = `
        <div class="flex items-center gap-3">
            <div class="text-xl">${types[type].icon}</div>
            <div class="flex-1">${message}</div>
            <button onclick="this.parentElement.parentElement.remove()" class="text-xl hover:opacity-70">&times;</button>
        </div>
    `;
    
    document.body.appendChild(notif);
    
    setTimeout(() => {
        if (notif.parentElement) {
            notif.style.opacity = '0';
            notif.style.transition = 'opacity 0.3s';
            setTimeout(() => notif.remove(), 300);
        }
    }, 5000);
}

// ============================================
// Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
// ============================================
function resetForm() {
    document.getElementById('join-form').reset();
    document.getElementById('wilayat').disabled = true;
    document.getElementById('wilayat').innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ©...</option>';
    document.getElementById('form-container').classList.remove('hidden');
    document.getElementById('success-message').classList.add('hidden');
    document.getElementById('form-status').classList.add('hidden');
}

// ============================================
// Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ† Ø§Ù„Ù…Ø­Ø³Ù†
// ============================================
function showAdminLogin() {
    document.getElementById('admin-login-modal').classList.remove('hidden');
    document.getElementById('admin-password').value = '';
    document.getElementById('login-error').classList.add('hidden');
    document.getElementById('admin-password').focus();
}

function hideAdminLogin() {
    document.getElementById('admin-login-modal').classList.add('hidden');
}

document.getElementById('admin-login-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const password = document.getElementById('admin-password').value;
    const loginBtn = document.getElementById('login-btn');
    const errorDiv = document.getElementById('login-error');
    
    loginBtn.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...';
    loginBtn.disabled = true;
    errorDiv.classList.add('hidden');
    
    try {
        showLoading();
        
        const response = await fetch(`${SCRIPT_URL}?action=adminLogin&password=${encodeURIComponent(password)}&t=${Date.now()}`);
        const data = await response.json();
        
        if (data.status === 'success' && data.authenticated) {
            adminPassword = password;
            hideAdminLogin();
            openAdminPanel();
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        } else {
            errorDiv.textContent = 'âŒ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©';
            errorDiv.classList.remove('hidden');
            this.classList.add('shake');
            setTimeout(() => this.classList.remove('shake'), 500);
            document.getElementById('admin-password').value = '';
            document.getElementById('admin-password').focus();
            showNotification('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
        }
        
    } catch (error) {
        console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', error);
        errorDiv.textContent = 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…';
        errorDiv.classList.remove('hidden');
        showNotification('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…', 'error');
    } finally {
        hideLoading();
        loginBtn.textContent = 'âœ… Ø¯Ø®ÙˆÙ„';
        loginBtn.disabled = false;
    }
});

// ============================================
// Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø­Ø³Ù†Ø©
// ============================================
function openAdminPanel() {
    document.getElementById('admin-panel').classList.remove('hidden');
    document.body.style.overflow = 'hidden';
    updateDebugInfo();
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
    const cachedRecords = loadFromLocalStorage('admin_records');
    if (cachedRecords) {
        allRecords = cachedRecords;
        filteredRecords = [...allRecords];
        displayStats();
        displayRecords();
        showNotification('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©', 'info');
    }
    
    // Ø«Ù… ØªØ­Ø¯ÙŠØ« Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
    setTimeout(loadAllRecords, 1000);
}

function logoutAdmin() {
    if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
        adminPassword = null;
        document.getElementById('admin-panel').classList.add('hidden');
        document.body.style.overflow = 'auto';
        showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'info');
    }
}

async function adminTestConnection() {
    const resultDiv = document.getElementById('admin-test-result');
    resultDiv.innerHTML = '<div class="text-blue-400 animate-pulse flex items-center gap-2"><div class="w-3 h-3 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"></div>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</div>';
    
    try {
        showLoading();
        const response = await fetch(`${SCRIPT_URL}?action=test&t=${Date.now()}`);
        const data = await response.json();
        
        resultDiv.innerHTML = `
            <div class="text-green-400 font-bold mb-1">âœ… Ù…ØªØµÙ„ Ø¨Ù†Ø¬Ø§Ø­</div>
            <div class="text-gray-300 text-sm">${data.message}</div>
        `;
        
    } catch (error) {
        resultDiv.innerHTML = `
            <div class="text-red-400 font-bold mb-1">âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„</div>
            <div class="text-gray-300 text-sm">${error.message}</div>
        `;
    } finally {
        hideLoading();
    }
}

async function loadAllRecords() {
    if (!adminPassword) {
        showNotification('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
        return;
    }
    
    const resultDiv = document.getElementById('admin-test-result');
    resultDiv.innerHTML = '<div class="text-blue-400 animate-pulse flex items-center gap-2"><div class="w-3 h-3 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"></div>Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>';
    
    try {
        showLoading();
        
        const url = `${SCRIPT_URL}?action=getAll&password=${encodeURIComponent(adminPassword)}&t=${Date.now()}`;
        const response = await fetch(url);
        const data = await response.json();
        
        if (data.code === 'UNAUTHORIZED') {
            showNotification('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©ØŒ Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'error');
            setTimeout(logoutAdmin, 2000);
            return;
        }
        
        if (data.status === 'success') {
            allRecords = data.data || [];
            filteredRecords = [...allRecords];
            
            // Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ
            saveToLocalStorage('admin_records', allRecords);
            
            displayStats();
            displayRecords();
            
            resultDiv.innerHTML = `
                <div class="text-green-400 font-bold mb-1">âœ… ØªÙ… Ø¬Ù„Ø¨ ${allRecords.length} Ø·Ù„Ø¨</div>
                <div class="text-gray-300 text-sm">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date().toLocaleString('ar-SA')}</div>
            `;
            
            showNotification(`ØªÙ… ØªØ­Ø¯ÙŠØ« ${allRecords.length} Ø³Ø¬Ù„`, 'success');
        } else {
            resultDiv.innerHTML = `
                <div class="text-red-400 font-bold mb-1">âŒ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                <div class="text-gray-300 text-sm">${data.message}</div>
            `;
            displayRecords([]);
        }
        
    } catch (error) {
        resultDiv.innerHTML = `
            <div class="text-red-400 font-bold mb-1">âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„</div>
            <div class="text-gray-300 text-sm">${error.message}</div>
        `;
        console.error('âŒ Ø®Ø·Ø£ GET:', error);
    } finally {
        hideLoading();
    }
}

// ============================================
// Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©
// ============================================
function displayStats() {
    document.getElementById('total-count').textContent = allRecords.length;
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙŠÙˆÙ…
    const today = new Date().toLocaleDateString('en-CA');
    const todayCount = allRecords.filter(record => {
        const recordDate = new Date(record['ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„'] || record.submitted_at).toLocaleDateString('en-CA');
        return recordDate === today;
    }).length;
    document.getElementById('today-count').textContent = todayCount;
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
    const oneWeekAgo = new Date();
    oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
    const weekCount = allRecords.filter(record => {
        const recordDate = new Date(record['ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„'] || record.submitted_at);
        return recordDate >= oneWeekAgo;
    }).length;
    document.getElementById('week-count').textContent = weekCount;
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (ÙŠÙ…ÙƒÙ† ØªØ®ØµÙŠØµÙ‡ Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ)
    document.getElementById('remaining-count').textContent = Math.max(0, 100 - allRecords.length);
}

// ============================================
###
